<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mascot Integration Catalog</title>
<style>
  body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; color: #333; }
  h1 { margin-bottom: 1rem; }
  input, select { margin: 0.5rem 0; padding: 0.5rem; font-size: 1rem; }
  .doc { margin-bottom: 0.5rem; padding: 0.5rem; background: #fff; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
  .status { font-size: 0.85em; color: #666; margin-left: 0.5rem; }
</style>
</head>
<body>

<h1>Integration Catalog</h1>

<input id="search" placeholder="Search by category or format...">
<select id="categoryFilter">
  <option value="">All Categories</option>
</select>
<select id="statusFilter">
  <option value="">All Statuses</option>
  <option value="planned">Planned</option>
  <option value="beta">Beta</option>
  <option value="stable">Stable</option>
</select>

<div id="docs"></div>

<script>
  async function loadCatalog() {
    const res = await fetch('catalog.json');
    const catalog = await res.json();
    return catalog.categories.flatMap(cat =>
      cat.formats.map(fmt => ({
        category: cat.name,
        name: fmt.name,
        docUrl: fmt.docUrl,
        status: fmt.status || ''
      }))
    );
  }

  function renderCategoryOptions(docs) {
    const categories = [...new Set(docs.map(d => d.category))];
    const select = document.getElementById('categoryFilter');
    categories.forEach(cat => {
      const option = document.createElement('option');
      option.value = cat;
      option.textContent = cat;
      select.appendChild(option);
    });
  }

  function renderDocs(docs, filters = {}) {
    const { search = '', category = '', status = '' } = filters;
    const container = document.getElementById('docs');
    container.innerHTML = '';

    const filtered = docs.filter(d =>
      (!search || d.category.toLowerCase().includes(search) || d.name.toLowerCase().includes(search)) &&
      (!category || d.category === category) &&
      (!status || d.status.toLowerCase() === status)
    );

    if (!filtered.length) {
      container.textContent = 'No documents found.';
      return;
    }

    filtered.forEach(d => {
      const div = document.createElement('div');
      div.className = 'doc';
      div.innerHTML = `<a href="${d.docUrl}" target="_blank">${d.category} â†’ ${d.name}</a><span class="status">(${d.status})</span>`;
      container.appendChild(div);
    });
  }

  (async () => {
    const docs = await loadCatalog();
    renderCategoryOptions(docs);

    const searchInput = document.getElementById('search');
    const categorySelect = document.getElementById('categoryFilter');
    const statusSelect = document.getElementById('statusFilter');

    function update() {
      renderDocs(docs, {
        search: searchInput.value.toLowerCase(),
        category: categorySelect.value,
        status: statusSelect.value
      });
    }

    searchInput.addEventListener('input', update);
    categorySelect.addEventListener('change', update);
    statusSelect.addEventListener('change', update);

    update();
  })();
</script>

</body>
</html>

